
# üîß Exercici: Configuraci√≥ i √∫s de diversos triggers a Jenkins  

## üéØ Objectiu  
Configurar un conjunt de **jobs a Jenkins** que es disparin amb diferents triggers:  
‚úÖ **Trigger builds remotely (API)**  
‚úÖ **Build after other projects are built**  
‚úÖ **Build periodically**  
‚úÖ **GitHub hook trigger for GITScm polling**  
‚úÖ **Poll SCM**  

---

## üõ†Ô∏è Requisits previs  
- Un servidor **Jenkins** instal¬∑lat i en funcionament.  
- Un **repositori GitHub** configurat.  
- Un **Jenkins agent** amb Git i un JDK instal¬∑lats (si es treballa amb Java).  
- Els **plugins necessaris** instal¬∑lats:  
  - **Git Plugin**  
  - **Pipeline Plugin**  
  - **GitHub Integration Plugin** (opcional per als webhooks)  

---

## üìå Part 1: Creaci√≥ dels Jobs  

Crearem **tres jobs interconnectats** per treballar amb els diferents triggers.  

### üîπ Job 1: `Build-API-Trigger` (Trigger builds remotely)  
Aquest job es podr√† executar des d'un script o una crida REST API.  

#### **Configuraci√≥**  
1. A **Jenkins**, crea un nou **Freestyle project** amb el nom `"Build-API-Trigger"`.  
2. A **"Build Triggers"**, activa **"Trigger builds remotely (e.g., from scripts)"**.  
3. Assigna-li un **token** √∫nic, per exemple:  
   ```
   my-secret-token
   ```
4. A **"Build"**, afegeix un Shell Script senzill:  
   ```bash
   echo "Build triggered remotely via API"
   ```
5. Desa la configuraci√≥.  

#### **Prova d'execuci√≥ via API**  
Pots executar aquest job des de la l√≠nia de comandes amb `curl`:  
```bash
curl -X POST http://JENKINS_URL/job/Build-API-Trigger/build?token=my-secret-token
```
(Sustitueix `JENKINS_URL` per la URL real del teu servidor.)  

---

### üîπ Job 2: `SCM-Polling-Job` (Poll SCM & GitHub Hook Trigger)  
Aquest job s‚Äôexecutar√† **autom√†ticament** quan hi hagi canvis al repositori GitHub.  

#### **Configuraci√≥**  
1. Crea un **Freestyle project** anomenat `"SCM-Polling-Job"`.  
2. A **"Source Code Management"**, selecciona **Git** i afegeix l'URL del repositori.  
3. A **"Build Triggers"**, marca:  
   ‚úÖ **"GitHub hook trigger for GITScm polling"**  
   ‚úÖ **"Poll SCM"** i afegeix la seg√ºent expressi√≥ cron per comprovar cada 2 minuts:  
   ```
   H/2 * * * *
   ```
4. A **"Build"**, afegeix un Shell Script:  
   ```bash
   echo "Triggered by Poll SCM or GitHub webhook!"
   ```
5. Desa la configuraci√≥.  

#### **Prova d'execuci√≥**  
1. Configura un **webhook** al repositori **GitHub** (anant a `Settings > Webhooks`).  
2. Afegeix la seg√ºent **Payload URL**:  
   ```
   http://JENKINS_URL/github-webhook/
   ```
3. Fes un **commit & push** al repositori per verificar que el webhook funciona.  

---

### üîπ Job 3: `Periodic-Build-Job` (Build Periodically & Build after other projects are built)  
Aquest job s'executar√† autom√†ticament **cada dia** i tamb√© quan s'hagi completat el `SCM-Polling-Job`.  

#### **Configuraci√≥**  
1. Crea un **Freestyle project** anomenat `"Periodic-Build-Job"`.  
2. A **"Build Triggers"**, marca:  
   ‚úÖ **"Build periodically"** i afegeix l'expressi√≥ cron per executar cada dia a les 00:00:  
   ```
   0 0 * * *
   ```
   ‚úÖ **"Build after other projects are built"** i selecciona **"SCM-Polling-Job"**.  
3. A **"Build"**, afegeix un Shell Script:  
   ```bash
   echo "Build triggered by scheduler or after SCM-Polling-Job"
   ```
4. Desa la configuraci√≥.  

#### **Prova d'execuci√≥**  
1. Espera a que s'executi segons la programaci√≥.  
2. Tamb√© es pot for√ßar fent un **commit** al repositori i deixant que `SCM-Polling-Job` el desencadeni.  

---

## ‚úÖ Resultats esperats  

| **Trigger**                           | **Job activat**               | **Forma de prova** |
|----------------------------------------|-------------------------------|--------------------|
| **Trigger builds remotely (API)**       | `Build-API-Trigger`           | `curl` o script extern |
| **Poll SCM**                            | `SCM-Polling-Job`             | Fent un commit al repo |
| **GitHub Hook Trigger for GITScm polling** | `SCM-Polling-Job`             | Webhook GitHub |
| **Build periodically**                  | `Periodic-Build-Job`          | Esperar programaci√≥ |
| **Build after other projects are built** | `Periodic-Build-Job` despr√©s de `SCM-Polling-Job` | Fent un commit al repo |

---

## üìå Preguntes per reflexionar  
1Ô∏è‚É£ **Quin dels triggers √©s m√©s eficient per a detectar canvis en el codi?**  
2Ô∏è‚É£ **Quins avantatges t√© utilitzar un webhook en comptes de Poll SCM?**  
3Ô∏è‚É£ **Com podr√≠em modificar aquest exercici per fer un pipeline m√©s complex (amb test i deploy)?**  

---

Amb aquest exercici haur√†s treballat diversos **triggers de Jenkins** i entendr√†s com interactuen entre si. üöÄ  
